<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Chat Button with Logo</title>
    <style>
   #customChatButton {
    display: flex;
    align-items: center;
    background: transparent; 
    border: none;
    cursor: pointer;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
    position: fixed;
    width: auto;
    height: auto;
}

#customChatButton img {
    width: 60px; 
    height: auto;
    border-radius: 50%; 
    border: 3px solid black; 
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2); 
    transition: transform 0.3s ease;
}

#customChatButton:hover img {
    transform: scale(1.1); 
}

    </style>
</head>
<body>
    <h1>Welcome to Our Portal Great to see you!</h1>
    <p>Click the button below to chat with our Einstein Bot.</p>

    <button id="customChatButton" onclick="bootstrapChat()">
        <img src="https://turbostart.blob.core.windows.net/turbostart/hUOydNxWjXHu1646050108099.jpg" alt="Mahe Assist Logo" />
    </button>
    


    <script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
    <script type='text/javascript'>
        function bootstrapChat() {
            embedded_svc.bootstrapEmbeddedService();
            let button = document.getElementById("customChatButton");
    button.classList.toggle("expanded");
        }

        var initESW = function(gslbBaseURL) {
            embedded_svc.settings.displayHelpButton = false;
            embedded_svc.settings.language = '';


            embedded_svc.settings.enabledFeatures = ['LiveAgent'];
            embedded_svc.settings.entryFeature = 'LiveAgent';

           
            embedded_svc.settings.chatbotAvatarImgURL = 'https://turbostart.blob.core.windows.net/turbostart/hUOydNxWjXHu1646050108099.jpg';
            embedded_svc.settings.offlineSupportMinimizedTextImageURL = 'https://turbostart.blob.core.windows.net/turbostart/hUOydNxWjXHu1646050108099.jpg';


            embedded_svc.init(
            'https://maheslcm.my.salesforce.com',
            'https://maheslcm.my.site.com/facfeedback',
            gslbBaseURL,
            '00DS4000004ly6U',
            'Chat_Button',
            {
                baseLiveAgentContentURL: 'https://c.la11-core1.sfdc-y37hzm.salesforceliveagent.com/content',
                deploymentId: '572S40000007f6T',
                buttonId: '573S4000000EmmL',
                baseLiveAgentURL: 'https://d.la11-core1.sfdc-y37hzm.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'Chat_Button',
                isOfflineSupportEnabled: false
            }
        );
    };


    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://maheslcm.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function() {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
    
   function bootstrapChat() {
    embedded_svc.bootstrapEmbeddedService();
    document.getElementById("customChatButton").style.display = "none"; // Hide custom button when chat opens
}


    function monitorChatMinimize() {
    let chatContainer = document.querySelector('.embeddedServiceLiveAgentStateChat');
    let customButton = document.getElementById("customChatButton");

    if (!chatContainer) {
        console.warn("Chat container not found. Retrying...");
        setTimeout(monitorChatMinimize, 1000);
        return;
    }

    let observer = new MutationObserver(() => {
        if (chatContainer.style.display === "none" || chatContainer.classList.contains("minimized")) {
            customButton.style.display = "block"; // Show custom button when chat is minimized
        } else {
            customButton.style.display = "none"; // Hide custom button when chat is active
        }
    });

    observer.observe(chatContainer, { attributes: true, attributeFilter: ["style", "class"] });
}

// Run monitoring when the page loads
setTimeout(monitorChatMinimize, 3000);


    </script>
</body>
</html>
